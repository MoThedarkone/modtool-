<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CreatorCore Dashboard</title>
  <link rel="stylesheet" href="dashboard.css">
  <link rel="icon" href="https://static.wikia.nocookie.net/minecraft_gamepedia/images/8/87/Grass_Block_JE3_BE3.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <header>
    <img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/8/87/Grass_Block_JE3_BE3.png" alt="CC Logo">
    <h1>CreatorCore Dashboard</h1>
  </header>

  <div class="tab-container">
    <div class="tab active" data-platform="discord">Discord</div>
    <div class="tab" data-platform="twitch">Twitch</div>
  </div>

  <div id="chatbox"></div>

  <script>
    const protocol = location.protocol === 'https:' ? 'wss' : 'ws';
    const ws = new WebSocket(`${protocol}://${window.location.hostname}:3002`);

    const chatbox = document.getElementById('chatbox');
    const tabs = document.querySelectorAll('.tab');
    let currentPlatform = 'discord';

    function renderMessage(msg) {
      if (msg.platform !== currentPlatform) return;
      const div = document.createElement('div');
      div.className = `msg ${msg.platform}`;
      const icon = msg.platform === 'discord'
        ? 'https://cdn-icons-png.flaticon.com/512/2111/2111370.png'
        : 'https://cdn-icons-png.flaticon.com/512/5968/5968819.png';
      div.innerHTML = `<img src="${icon}" alt="icon" class="msg-icon"> [${msg.platform.toUpperCase()}] <strong>${msg.username}</strong>: ${msg.content}`;
      chatbox.appendChild(div);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    ws.onmessage = (event) => {
      try {
        const msg = JSON.parse(event.data);
        renderMessage(msg);
      } catch {}
    };

    tabs.forEach(tab => {
      tab.onclick = () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentPlatform = tab.dataset.platform;
        chatbox.innerHTML = ''; // In the future, reload messages if stored
      };
    });
  </script>

</body>
</html>

